<div class="entity-container">
  <div class="mat-elevation-z1 round-card white-bg p-4 mt-5">
    <div *ngIf="specimen">
      <div class="col-6">
        <h3 id="page-heading"><span jhiTranslate="alfairouzApp.specimen.detail.title">Specimen</span>{{ specimen?.id }}
        </h3>
      </div>
      <div class="col-12">
        <div class="text-left">
          <mat-menu #appMenu="matMenu">
            <button (click)="getReciept(specimen?.id)" mat-menu-item>
              <mat-icon>print</mat-icon>
              طباعة ايصال قبض
            </button>
            <button (click)="getNormalReport(specimen?.id)" mat-menu-item>
              <mat-icon>print</mat-icon>
              طباعة التقرير فقط
            </button>
            <button (click)="getReport(specimen?.id)" mat-menu-item>
              <mat-icon>print</mat-icon>
              طباعة التقرير ملون
            </button>
          </mat-menu>
          <button [matMenuTriggerFor]="appMenu" class="mr-2" mat-icon-button>
            <mat-icon>more_vert</mat-icon>
          </button>
        </div>
      </div>
      <br/>
      <mat-tab-group animationDuration="0ms">
        <mat-tab>
          <ng-template mat-tab-label>
            <span>بيانات العينة</span>
          </ng-template>
          <div class="m-4 mt-4">
            <br/>
            <div class="row detail-row mt-3 mb-4">
              <div class="col-4">
                <div class="text-muted" jhiTranslate="alfairouzApp.specimen.labQr">Lab Qr</div>
                <qrcode [qrdata]="getLabQr()" [width]="60"></qrcode>
                <h6 matLine>{{ specimen.labQr }}</h6>
              </div>
              <div class="col-4">
                <div class="text-muted">رقم العينة</div>
                <h6 matLine>{{ specimen.labRefNo }}</h6>
              </div>
              <div class="col-4">
                <div class="text-muted">حالة العينة</div>
                <h6 matLine jhiTranslate="{{ 'alfairouzApp.SpecimenStatus.' + specimen.specimenStatus }}">{{ specimen.specimenStatus }}</h6>
              </div>
            </div>

            <!-- Basic Information -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small">ID</div>
                  <div class="fw-bold">{{ specimen.id }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.samples">Samples</div>
                  <div class="fw-bold">{{ specimen.samples }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.blocks">Blocks</div>
                  <div class="fw-bold">{{ specimen.blocks }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.slides">Slides</div>
                  <div class="fw-bold">{{ specimen.slides }}</div>
                </div>
              </div>
            </div>

            <!-- Dates -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.samplingDate">Sampling Date</div>
                  <div class="fw-bold">{{ specimen.samplingDate | formatMediumDate }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.receivingDate">Receiving Date</div>
                  <div class="fw-bold">{{ specimen.receivingDate | formatMediumDate }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.reportDate">Report Date</div>
                  <div class="fw-bold">{{ specimen.reportDate | formatMediumDate }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.revisionDate">Revision Date</div>
                  <div class="fw-bold">{{ specimen.revisionDate | formatMediumDate }}</div>
                </div>
              </div>
            </div>

            <!-- Contract and Payment -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.contractType">Contract Type</div>
                  <div class="fw-bold" jhiTranslate="{{ 'alfairouzApp.ContractType.' + specimen.contractType }}">{{ specimen.contractType }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.paymentType">Payment Type</div>
                  <div class="fw-bold" jhiTranslate="{{ 'alfairouzApp.PaymentType.' + specimen.paymentType }}">{{ specimen.paymentType }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.price">Price</div>
                  <div class="fw-bold">{{ specimen.price }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.paid">Paid</div>
                  <div class="fw-bold">{{ specimen.paid }}</div>
                </div>
              </div>
            </div>

            <!-- File and Status -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.fileNo">File No</div>
                  <div class="fw-bold">{{ specimen.fileNo }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.results">Results</div>
                  <div class="fw-bold" jhiTranslate="{{ 'alfairouzApp.Results.' + specimen.results }}">{{ specimen.results }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.urgentSample">Urgent Sample</div>
                  <div class="fw-bold">{{ specimen.urgentSample }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.pdfFileUrl">PDF File</div>
                  <button [disabled]="!specimen.pdfFileUrl" (click)="openFileFromUrl(specimen.pdfFileUrl)"
                          color="primary" mat-raised-button type="button" class="btn-sm">
                    <mat-icon>picture_as_pdf</mat-icon>
                  </button>
                </div>
              </div>
            </div>

            <!-- Boolean Flags -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.isWithdrawn">Is Withdrawn</div>
                  <div class="fw-bold">
                    <mat-icon *ngIf="specimen.isWithdrawn" color="warn">check_circle</mat-icon>
                    <mat-icon *ngIf="!specimen.isWithdrawn" color="primary">cancel</mat-icon>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.receivedInFormalin">Received In Formalin</div>
                  <div class="fw-bold">
                    <mat-icon *ngIf="specimen.receivedInFormalin" color="primary">check_circle</mat-icon>
                    <mat-icon *ngIf="!specimen.receivedInFormalin">cancel</mat-icon>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.printedOut">Printed Out</div>
                  <div class="fw-bold">
                    <mat-icon *ngIf="specimen.printedOut" color="primary">check_circle</mat-icon>
                    <mat-icon *ngIf="!specimen.printedOut">cancel</mat-icon>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.smsSent">SMS Sent</div>
                  <div class="fw-bold">
                    <mat-icon *ngIf="specimen.smsSent" color="primary">check_circle</mat-icon>
                    <mat-icon *ngIf="!specimen.smsSent">cancel</mat-icon>
                  </div>
                </div>
              </div>
            </div>

            <!-- Related Entities -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.patient">Patient</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.patient" [routerLink]="['/patient', specimen.patient?.id, 'view']">
                      {{ specimen.patient?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.organ">Organ</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.organ" [routerLink]="['/organ', specimen.organ?.id, 'view']">
                      {{ specimen.organ?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.specimenType">Specimen Type</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.specimenType" [routerLink]="['/specimen-type', specimen.specimenType?.id, 'view']">
                      {{ specimen.specimenType?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.size">Size</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.size" [routerLink]="['/size', specimen.size?.id, 'view']">
                      {{ specimen.size?.name }}
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Medical Staff -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.pathologistDoctor">Pathologist Doctor</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.pathologistDoctor" [routerLink]="['/doctor', specimen.pathologistDoctor?.id, 'view']">
                      {{ specimen.pathologistDoctor?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.referringDoctor">Referring Doctor</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.referringDoctor" [routerLink]="['/doctor', specimen.referringDoctor?.id, 'view']">
                      {{ specimen.referringDoctor?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.grossingDoctor">Grossing Doctor</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.grossingDoctor" [routerLink]="['/doctor', specimen.grossingDoctor?.id, 'view']">
                      {{ specimen.grossingDoctor?.name }}
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.referringCenter">Referring Center</div>
                  <div class="fw-bold">
                    <a *ngIf="specimen.referringCenter" [routerLink]="['/referring-center', specimen.referringCenter?.id, 'view']">
                      {{ specimen.referringCenter?.name }}
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Text Areas -->
            <div class="row mb-3">
              <div class="col-6">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.clinicalData">Clinical Data</div>
                  <div class="fw-bold">{{ specimen.clinicalData }}</div>
                </div>
              </div>
              <div class="col-6">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.grossExamination">Gross Examination</div>
                  <div class="fw-bold">{{ specimen.grossExamination }}</div>
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-6">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.microscopicData">Microscopic Data</div>
                  <div class="fw-bold">{{ specimen.microscopicData }}</div>
                </div>
              </div>
              <div class="col-6">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="alfairouzApp.specimen.conclusion">Conclusion</div>
                  <div class="fw-bold">{{ specimen.conclusion }}</div>
                </div>
              </div>
            </div>

            <!-- Audit Information -->
            <div class="row mb-3">
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="userManagement.createdBy">Created By</div>
                  <div class="fw-bold">{{ specimen.createdBy }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="userManagement.createdDate">Created Date</div>
                  <div class="fw-bold">{{ specimen.createdDate | date: 'dd/MM/yy HH:mm' }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="userManagement.lastModifiedBy">Last Modified By</div>
                  <div class="fw-bold">{{ specimen.lastModifiedBy }}</div>
                </div>
              </div>
              <div class="col-3">
                <div class="detail-card p-3">
                  <div class="text-muted small" jhiTranslate="userManagement.lastModifiedDate">Last Modified Date</div>
                  <div class="fw-bold">{{ specimen.lastModifiedDate | date: 'dd/MM/yy HH:mm' }}</div>
                </div>
              </div>
            </div>
          </div>
        </mat-tab>

        <mat-tab>
          <ng-template mat-tab-label>
            <span>سجلات التعديل</span>
          </ng-template>
          <div class="m-4 mt-4">
            <br/>
            <div class="table-responsive" *ngIf="specimenEdits && specimenEdits.length > 0">
              <table class="table table-striped">
                <thead>
                <tr>
                  <th scope="col"><span>#</span></th>
                  <th scope="col"><span>Status From</span></th>
                  <th scope="col"><span>Status To</span></th>
                  <th scope="col"><span>User Type</span></th>
                  <th scope="col"><span>Lab Ref No</span></th>
                  <th scope="col"><span>Created By</span></th>
                  <th scope="col"><span>Created At</span></th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let specimenEdit of specimenEdits;" data-cy="entityTable">
                  <td><a>{{ specimenEdit.id }}</a></td>
                  <td>{{ specimenEdit.specimenStatusFrom }}</td>
                  <td>{{ specimenEdit.specimenStatusTo }}</td>
                  <td>{{ specimenEdit.userType }}</td>
                  <td>{{ specimenEdit.labRefNo }}</td>
                  <td>{{ specimenEdit.createdBy }}</td>
                  <td>{{ specimenEdit.createdDate }}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>

      <hr/>
      <jhi-alert-error></jhi-alert-error>
      <jhi-alert></jhi-alert>

      <button type="submit" (click)="previousState()" class="btn btn-info" data-cy="entityDetailsBackButton">
        <fa-icon icon="arrow-left"></fa-icon>&nbsp;<span jhiTranslate="entity.action.back">Back</span>
      </button>

      <button type="button" [routerLink]="['/specimen', specimen.id, 'edit']" class="btn btn-primary">
        <fa-icon icon="pencil-alt"></fa-icon>&nbsp;<span jhiTranslate="entity.action.edit">Edit</span>
      </button>
    </div>
  </div>
</div>
